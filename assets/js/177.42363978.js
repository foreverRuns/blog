(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{857:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"本站部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本站部署"}},[s._v("#")]),s._v(" 本站部署")]),s._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),t("p",[s._v("VuePress 官方提供了很多平台的部署实现，具体 "),t("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/deploy.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("看这里"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("本站目前是部署到 "),t("code",[s._v("GitHub Pages")]),s._v(" 并同步部署到 "),t("code",[s._v("Gitee Pages")]),s._v(" 上。")]),s._v(" "),t("h2",{attrs:{id:"github-pages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github-pages"}},[s._v("#")]),s._v(" GitHub Pages")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.github.com/cn/pages",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Pages"),t("OutboundLink")],1),s._v(" 是一个静态站点托管服务，可用于托管个人的静态网站。很多人用它来搭建私人博客，省去了购买服务器、域名等等一系列复杂的操作。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.github.com/cn/pages/getting-started-with-github-pages/about-github-pages#",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Pages Sites"),t("OutboundLink")],1),s._v(" 有三种类型：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用户站点 "),t("code",[s._v("user")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("要发布用户站点，必须创建一个名为 "),t("code",[s._v("<username>.github.io")]),s._v(" 的用户仓库")]),s._v(" "),t("li",[s._v("用户站点的默认发布源是仓库的默认分支 "),t("code",[s._v("main/master")]),s._v(" 根目录")]),s._v(" "),t("li",[s._v("通过 "),t("code",[s._v("https://<username>.github.io/")]),s._v(" 访问")])])]),s._v(" "),t("li",[t("p",[s._v("组织站点 "),t("code",[s._v("organization")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("要发布组织站点，必须创建一个名为 "),t("code",[s._v("<organization>.github.io")]),s._v(" 的组织仓库")]),s._v(" "),t("li",[s._v("组织站点的默认发布源是仓库的默认分支 "),t("code",[s._v("main/master")]),s._v(" 根目录")]),s._v(" "),t("li",[s._v("通过 "),t("code",[s._v("https://<organization>.github.io/")]),s._v(" 访问")])])]),s._v(" "),t("li",[t("p",[s._v("项目站点 "),t("code",[s._v("project")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("要发布项目站点，仓库名字可以随便取，比如 "),t("code",[s._v("blog")])]),s._v(" "),t("li",[s._v("项目站点的默认发布源是 "),t("code",[s._v("gh pages")]),s._v(" 分支根目录")]),s._v(" "),t("li",[s._v("通过 "),t("code",[s._v("https://<username>.github.io/<REPO>/")]),s._v(" 或 "),t("code",[s._v("https://<organization>.github.io/<REPO>/")]),s._v(" 访问。比如："),t("code",[s._v("https://<username>.github.io/blog")])])])])]),s._v(" "),t("p",[s._v("在此之前，你需要在 "),t("code",[s._v("docs/.vuepress/config.js")]),s._v(" 中设置正确的 "),t("code",[s._v("base")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("如果你打算发布到 "),t("code",[s._v("https://<USERNAME>.github.io/")]),s._v("，则无需配置 "),t("code",[s._v("base")]),s._v("，因为 "),t("code",[s._v("base")]),s._v(" 默认即是 "),t("code",[s._v('"/"')]),s._v("。")]),s._v(" "),t("li",[s._v("如果你打算发布到 "),t("code",[s._v("https://<USERNAME>.github.io/<REPO>/")]),s._v("（也就是说你的仓库在 "),t("code",[s._v("https://github.com/<USERNAME>/<REPO>")]),s._v("），则将 "),t("code",[s._v("base")]),s._v(" 设置为 "),t("code",[s._v('"/<REPO>/"')]),s._v("。")])]),s._v(" "),t("p",[s._v("本站是单独部署在 "),t("code",[s._v("https://github.com/foreverRuns/blog")]),s._v(" 仓库的 "),t("code",[s._v("gh-pages")]),s._v(" 分支上，所以设置为 "),t("code",[s._v("base: '/blog/'")])]),s._v(" "),t("p",[s._v("为什么不部署到代码仓库 "),t("code",[s._v("https://github.com/foreverRuns/vuepress-vdoing-blog")]),s._v(" 的 "),t("code",[s._v("gh-pages")]),s._v(" 分支上？"),t("br"),s._v("\n因为后面可能代码或文档由于某些原因可能会将仓库变为私有，由于开启 GitHub Pages 的仓库需要公开，部署到 blog 仓库上就不受影响。")]),s._v(" "),t("h3",{attrs:{id:"创建代码仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建代码仓库"}},[s._v("#")]),s._v(" 创建代码仓库")]),s._v(" "),t("blockquote",[t("p",[s._v("没有 "),t("code",[s._v("Github")]),s._v(" 账号的，"),t("a",{attrs:{href:"https://github.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击这里"),t("OutboundLink")],1),s._v(" 去注册")])]),s._v(" "),t("ol",[t("li",[s._v("右上角 "),t("code",[s._v("+")]),s._v("，选择 "),t("code",[s._v("New repository")]),s._v(" 新建一个仓库存放代码")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubNewRep.cgpssz2toc0.webp",alt:"githubNewRep"}})]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("本地使用 "),t("code",[s._v("git")]),s._v(" 管理项目")])]),s._v(" "),t("ul",[t("li",[s._v("进入项目根目录 "),t("code",[s._v("vuepress-vdoing-blog")])])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改默认主分支名称，跟 github 仓库一样")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" master main\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加远程仓库地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" remote "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" origin https://github.com/foreverRuns/vuepress-vdoing-blog.git\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取远程仓库，同步到本地 (因为创建仓库时我们添加了 LICENSE 跟 README.md，如果创建的是空仓库不需要先 pull)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" pull origin main\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("现在 github 仓库默认主分支更改为 "),t("code",[s._v("main")]),s._v("，本地 git init 初始化默认主分支为 "),t("code",[s._v("master")]),s._v("。 "),t("RouterLink",{attrs:{to:"/01.文章/99.其他/99.git/02.github默认分支.html"}},[s._v("看这里")])],1)]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("提交代码到远程github仓库")])]),s._v(" "),t("ul",[t("li",[s._v("创建 "),t("code",[s._v(".gitignore")]),s._v(" 文件，写上不需要上传到远程仓库的文件")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("node_modules\nyarn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vscode\ndocs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vuepress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("提交代码")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把项目的所有文件添加到本地仓库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 填写本次提交的描述")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'init'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地仓库推送到远程仓库, 如果创建的远程仓库是空仓库，第一次提交时需要创建并提交 git push -u origin main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push origin main\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("提交出错看这里")]),s._v(" "),t("p",[s._v("Support for password authentication was removed on August 13, 2021. Please use a personal access token instead."),t("br"),s._v("\nGithub 现在需要使用 token 认证，"),t("RouterLink",{attrs:{to:"/01.文章/99.其他/99.git/04.githubToken.html"}},[s._v("教程看这里")]),s._v("。"),t("br"),s._v("\n设置 token 拥有的权限时候，勾上 repo 跟 workflow，因为后面远程部署用到 github action，需要 workflow 权限。")],1)]),s._v(" "),t("h3",{attrs:{id:"创建部署仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建部署仓库"}},[s._v("#")]),s._v(" 创建部署仓库")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("右上角 "),t("code",[s._v("+")]),s._v("，选择 "),t("code",[s._v("New repository")]),s._v(" 新建仓库 "),t("code",[s._v("blog")]),s._v(" 用于存放构建打包后的代码，即将博客部署到该仓库下。仓库名称即为 "),t("code",[s._v("docs/.vuepress/config.js")]),s._v(" 中 "),t("code",[s._v("base")]),s._v(" 设置的值")])]),s._v(" "),t("li",[t("p",[s._v("进入该仓库，点击左上角的 "),t("code",[s._v("main")]),s._v(" 分支下拉按钮，在输入框中输入 "),t("code",[s._v("gh-pages")]),s._v("，点击下面生成的 "),t("code",[s._v("Create branch: gh-pages from main")]),s._v(" 创建 "),t("code",[s._v("gh-pages")]),s._v(" 分支")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubBlog1.1b8e2usawphc.webp",alt:"githubBlog1"}})]),s._v(" "),t("p",[s._v("然后仓库上面 "),t("code",[s._v("Settings/Pages/")]),s._v(" 下：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubBlog3.2azig9s7o96o.webp",alt:"githubBlog3"}})]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[t("code",[s._v("gh-pages")]),s._v(" 分支根目录是 "),t("code",[s._v("项目站点 即 project 类型")]),s._v(" 的默认发布源，所以上面设置默认就设置好了。如果在分支发布，则需要在上面 "),t("code",[s._v("Pages")]),s._v(" 设置下选择对应的分支。")])]),s._v(" "),t("ol",[t("li",[s._v("构建打包，生成静态文件，默认生成在 "),t("code",[s._v("docs/.vuepress/dist")]),s._v(" 下。")])]),s._v(" "),t("code-group",[t("code-block",{attrs:{title:"YARN",active:""}},[t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("code-block",{attrs:{title:"NPM"}},[t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])],1),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[s._v("进入打包的目录 "),t("code",[s._v("docs/.vuepress/dist")]),s._v("，将生成的文件推送到部署仓库的 "),t("code",[s._v("gh-pages")]),s._v(" 分支下")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'手动部署'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" git@github.com:foreverRuns/blog.git master:gh-pages\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("blockquote",[t("p",[s._v("解释一下 "),t("code",[s._v("git push -f git@github.com:foreverRuns/blog.git master:gh-pages")]),s._v(" :")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-f")]),s._v(" 是 --force的缩写，强制覆盖远程仓库。注意：-f 有风险，master/main 主分支上请谨慎使用")]),s._v(" "),t("li",[t("code",[s._v("git@github.com:foreverRuns/blog.git")]),s._v(" 是你的仓库地址，可以是 HTTPS/SSH 地址，记不住的可以直接在你的仓库右边绿色的 Code 按钮下复制")]),s._v(" "),t("li",[t("code",[s._v("master:gh-pages")]),s._v(" 是 将本地 master 分支 推送到远程 gh-pages 分支。这里为什么是 master 而不是 main，因为上面 git init 初始化默认分支就是 master")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubBlog2.2v3wu96has00.webp",alt:"githubBlog2"}})]),s._v(" "),t("p",[s._v("推送成功后，你就将你的网站部署到了 "),t("code",[s._v("https://<USERNAME>.github.io/<REPO>/")]),s._v(" 上，本站是 "),t("code",[s._v("https://foreverRuns.github.io/blog/")]),s._v("。")]),s._v(" "),t("blockquote",[t("p",[s._v("Github 只要更新了 gh-pages 分支内容，就会立刻自动重新部署，所以访问页面是最新的。")])]),s._v(" "),t("h3",{attrs:{id:"本地手动部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地手动部署"}},[s._v("#")]),s._v(" 本地手动部署")]),s._v(" "),t("p",[s._v("到这里，已经是部署成功了，但是每次修改代码或者更新你的博客文章时，都需要重新打包构建，并执行上面命令去手动部署，这很繁琐。")]),s._v(" "),t("p",[s._v("需要频繁执行一系列命令时，可以将其写到 bash 脚本中，通过执行脚本去执行一系列命令。不懂 bash 的，"),t("a",{attrs:{href:"https://wangdoc.com/bash/intro.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("看这里"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("ol",[t("li",[s._v("在项目根目录新建 "),t("code",[s._v("deploy.sh")]),s._v(" 部署脚本：")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("msg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'本地手动部署'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#yarn deploy")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("githubUrl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://github.com/foreverRuns/blog\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地部署")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${msg}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$githubUrl")]),s._v(" master:gh-pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地master分支 推送到远程 blog 仓库下的 gh-pages 分支")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退回开始所在目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除打包目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" docs/.vuepress/dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("blockquote",[t("p",[s._v("执行该脚本需要支持 "),t("code",[s._v("bash 命令的窗口")]),s._v("，Windows 终端无法执行")])]),s._v(" "),t("p",[s._v("在项目根目录右键，选择 "),t("code",[s._v("Git Bash Here")]),s._v(" 打开 Git Bash 窗口，输入：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" deploy.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("即可通过脚本一键部署")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("将该命令写到 "),t("code",[s._v("package.json")]),s._v(" 中的 "),t("code",[s._v("scripts")]),s._v(" 中统一管理")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"dev"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress dev docs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"build"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress build docs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"deploy"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash deploy.sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("这样，执行以下命令就可以实现一键部署")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" deploy\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"远程自动部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#远程自动部署"}},[s._v("#")]),s._v(" 远程自动部署")]),s._v(" "),t("p",[s._v("到这里，我们只需要执行 "),t("code",[s._v("yarn deploy")]),s._v(" 就可以实现一键部署了，但是当你想在远程仓库在线更新博客时，需要本地先 "),t("code",[s._v("pull")]),s._v(" 拉取远程代码，然后再本地打包部署，相当麻烦。")]),s._v(" "),t("p",[s._v("我们使用 "),t("code",[s._v("GitHub Actions")]),s._v(" 可以实现在修改完代码或者更新博客，把代码 "),t("code",[s._v("push")]),s._v(" 到代码仓库后，在远程自动执行上面脚本去部署。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Actions"),t("OutboundLink")],1),s._v(" 是 GitHub 的 "),t("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2015/09/continuous-integration.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("持续集成服务"),t("OutboundLink")],1),s._v("，不了解的先移步本站 "),t("RouterLink",{attrs:{to:"/01.文章/99.其他/99.git/05.GitHubActions.html"}},[s._v("GitHub Actions 入门教程")]),s._v("。")],1),s._v(" "),t("h4",{attrs:{id:"配置-access-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-access-token"}},[s._v("#")]),s._v(" 配置 ACCESS_TOKEN")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("首先需要申请一个 "),t("code",[s._v("personal access token")]),s._v("， "),t("RouterLink",{attrs:{to:"/01.文章/99.其他/99.git/04.githubToken.html"}},[s._v("怎么申请看这里")]),s._v("，设置权限时勾上 "),t("code",[s._v("workflow")]),s._v("。")],1)]),s._v(" "),t("li",[t("p",[s._v("这个 token 用于远程部署提交代码时的权限验证，就像本地第一次提交代码时也需要设置 token 一样。"),t("br"),s._v("\n由于 token 的私密性，不应该直接放在脚本中，我们可以放到 "),t("code",[s._v("代码仓库")]),s._v(" 的 "),t("code",[s._v("Settings/secrets/actions")]),s._v(" 下，通过环境变量去获取 token，具体如下：")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubSecrets1.3jkko9zmh9hc.webp",alt:"githubSecrets1"}})]),s._v(" "),t("p",[s._v("点击上面的 "),t("code",[s._v("New repository secret")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubSecrets2.wp92dryb128.webp",alt:"githubSecrets2"}})]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("token 的名字设置为 "),t("code",[s._v("ACCESS_TOKEN")]),s._v("，那么我们在脚本中就可以通过")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("来获取该 token，"),t("a",{attrs:{href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方 secrets 说明文档"),t("OutboundLink")],1)])]),s._v(" "),t("h4",{attrs:{id:"配置-action-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-action-脚本"}},[s._v("#")]),s._v(" 配置 action 脚本")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("在项目根目录下，新建 "),t("code",[s._v(".github/workflows")]),s._v(" 目录，必须这个名字，因为 GitHub Actions 就是这么规定的，只要该目录下有 "),t("code",[s._v(".yml")]),s._v(" 脚本就会去自动执行")])]),s._v(" "),t("li",[t("p",[s._v("在 "),t("code",[s._v(".github/workflows")]),s._v(" 目录下新建 "),t("code",[s._v("ci.yml")]),s._v(" 脚本，脚本名字可以自定义")])])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CI\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 触发条件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在master分支发生push事件时触发。")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("push")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" main\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mater\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持手动，方便测试 (在github仓库的action下对应的action开启了Runs workflow 按钮)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_dispatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时区（设置时区可使页面中的`最近更新时间`使用时区时间）")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工作流")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义名称")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行在最新的ubuntu虚拟机环境")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("strategy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matrix")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("14.x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Checkout "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤1 拉取代码")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用的动作。格式：userName/repoName。作用：检出仓库，获取源码。 官方actions库：https://github.com/actions")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Number of commits to fetch. 0 indicates all history for all branches and tags.")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default: 1")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fetch-depth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0 表示获取所有分支和标签的所有 Commit 记录。 (文章底部的 `最近更新时间` 对应该文章的 commit 提交时间，没有设置这个会出现问题)")]),s._v("\n          \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Use Node.js $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" matrix.node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("version "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤2")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node@v1 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 作用：安装nodejs")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" matrix.node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("version "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" run deploy.sh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤3")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("GITHUB_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# toKen私密变量 (在 仓库/Settings/Secrets/Actions/ 下， New repository secret 创建)")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yarn "),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" yarn deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖，执行deploy.sh")]),s._v("\n\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤3 （只需要github action自动部署, 不需要本地部署的可以使用这个步骤）")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - name: Install and Build # npm install npm run build")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   run: |")]),t("span",{pre:!0,attrs:{class:"token scalar string"}},[s._v("\n      #     yarn\n      #     yarn build\n      #     # cd docs/.vuepress/dist\n      #     # echo 'xxx.com' > CNAME\n      #     # cd -\n      # - name: Deploy\n      #   uses: JamesIves/github-pages-deploy-action@v4.2.2 # V4 开始不需要添加 token ，如果添加会报 128 错误。 https://github.com/JamesIves/github-pages-deploy-action\n      #   with:\n      #     branch: gh-pages # The branch the action should deploy to.\n      #     folder: docs/.vuepress/dist # The folder the action should deploy.\n      #     # This option defaults to the repository scoped GitHub Token.\n      #     # 2021年8月13日开始，GitHub不再支持密码验证解决方案，需要使用token登录\n      #     # JamesIves/github-pages-deploy-action v4 版本默认使用仓库登录的token\n      #     # 如果你只是部署到本仓库的gh-pages下，不需要再提供token了，如果添加会报 128 错误\n      #     # 如果你需要部署到其他仓库，只需要提供 access token\n      #     token: ${{ secrets.ACCESS_TOKEN }}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br")])]),t("blockquote",[t("p",[s._v("看不懂脚本的, 移步本站 "),t("RouterLink",{attrs:{to:"/01.文章/99.其他/99.git/05.GitHubActions.html"}},[s._v("GitHub Actions 入门教程")]),s._v("。")],1)]),s._v(" "),t("p",[s._v("这个脚本文件会在 "),t("code",[s._v("master")]),s._v(" 或者 "),t("code",[s._v("main")]),s._v(" 分支发生 "),t("code",[s._v("push")]),s._v(" 事件时触发，运行环境是 "),t("code",[s._v("ubuntu-latest")]),s._v("，工作步骤为：")]),s._v(" "),t("ol",[t("li",[s._v("拉取仓库源码")]),s._v(" "),t("li",[s._v("安装 nodejs，因为打包项目要用到 nodejs")]),s._v(" "),t("li",[s._v("把 "),t("code",[s._v("token")]),s._v(" 设置到环境变量，安装项目依赖，并运行 "),t("code",[s._v("deploy.sh")]),s._v(" 脚本，进行打包及部署")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("如果你不需要本地脚本手动部署, 可以将上面的的 "),t("code",[s._v("步骤三")]),s._v(" 屏蔽掉, 打开最下面已经屏蔽的 "),t("code",[s._v("步骤三")]),s._v(", 这样就可以实现远程自动部署了, 也就不需要 "),t("code",[s._v("deploy.sh")]),s._v(" 脚本了")])]),s._v(" "),t("h4",{attrs:{id:"修改-deploy-sh-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-deploy-sh-脚本"}},[s._v("#")]),s._v(" 修改 deploy.sh 脚本")]),s._v(" "),t("p",[s._v("修改在项目根目录下的 "),t("code",[s._v("deploy.sh")]),s._v(" 部署脚本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到自定义域名，请使用，不填则使用 GitHub 自带的 <username>.github.io")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'www.example.com' > CNAME")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-z")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GITHUB_TOKEN")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("msg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'本地手动部署'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地 yarn deploy")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("githubUrl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://github.com/foreverRuns/blog\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("msg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitHub Actions 自动部署'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("githubUrl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://foreverRuns:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GITHUB_TOKEN}")]),s._v("@github.com/foreverRuns/blog.git\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Omit --global to set the identity only in this repository.")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foreverRuns"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.email "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"894xxxx40@qq.com"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${msg}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$githubUrl")]),s._v(" master:gh-pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 master 分支 推送到 blog 仓库下的 gh-pages分支")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退回开始所在目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除打包项目")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" docs/.vuepress/dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("p",[s._v("这个脚本现在执行过程是这样的：")]),s._v(" "),t("ol",[t("li",[s._v("先运行打包命令，生成 "),t("code",[s._v("docs/.vuepress/dist")]),s._v(" 文件")]),s._v(" "),t("li",[s._v("判断环境变量 "),t("code",[s._v("GITHUB_TOKEN")]),s._v(" 是否存在，存在则是本地 "),t("code",[s._v("yarn deploy")]),s._v(" 手动执行脚本，否则是远程 "),t("code",[s._v("Github Actions")]),s._v(" 通过执行 "),t("code",[s._v("ci.yml")]),s._v(" 脚本自动执行")]),s._v(" "),t("li",[s._v("根据结果设置相应的变量")]),s._v(" "),t("li",[s._v("将打包后的文件推送到对应仓库的 "),t("code",[s._v("gh-pages")]),s._v(" 分支下")])]),s._v(" "),t("p",[s._v("至此，我们就可以实现本地 "),t("code",[s._v("push")]),s._v(" 代码到 github 仓库的 "),t("code",[s._v("main")]),s._v(" 分支后，远程自动部署了")]),s._v(" "),t("p",[s._v("可以在 github 仓库的 "),t("code",[s._v("Actions")]),s._v(" 选项下查看部署日志。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubActionLog.38hw60tfx7ls.webp",alt:"githubActionLog"}})]),s._v(" "),t("blockquote",[t("p",[s._v("由于在国内 "),t("code",[s._v("GitHub")]),s._v(" 不稳定，网速很慢🐌，经常连不上🐛，着急的时候真抓狂💥。接下来我们将同步部署到访问速度更快的 "),t("code",[s._v("Gitee Pages")]),s._v("。")])]),s._v(" "),t("h2",{attrs:{id:"gitee-pages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitee-pages"}},[s._v("#")]),s._v(" Gitee Pages")]),s._v(" "),t("p",[t("code",[s._v("Gitee Pages")]),s._v(" 是一个免费的静态网页托管服务，在国内它的访问速度很快，很多人使用它来托管博客、项目官网等静态网页。但它不像 "),t("code",[s._v("GitHub Pages")]),s._v(" 那样，一提交代码就能自动更新 Pages，因为 Gitee 的自动部署属于 "),t("code",[s._v("Gitee Pages Pro")]),s._v(" 的服务。")]),s._v(" "),t("p",[s._v("但我们可以通过 "),t("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gitee Pages Action"),t("OutboundLink")],1),s._v(" 来实现 "),t("code",[s._v("Gitee Pages")]),s._v(" 的自动部署。")]),s._v(" "),t("blockquote",[t("p",[s._v("注：首次需要手动登录 Gitee ，进入项目 "),t("code",[s._v("服务")]),s._v(" 下的 "),t("code",[s._v("Gitee Pages")]),s._v("，手动点击 "),t("code",[s._v("启动")]),s._v(" 进行 Gitee Pages 服务的部署。")])]),s._v(" "),t("blockquote",[t("p",[s._v("没有 "),t("code",[s._v("Gitee")]),s._v(" 账号的，"),t("a",{attrs:{href:"https://gitee.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击这里"),t("OutboundLink")],1),s._v(" 先去注册。")])]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("点击查看提示")]),s._v(" "),t("p",[t("code",[s._v("Gitee Pages")]),s._v(" 不会一提交代码就能自动更新 Pages，需要手动去更新。自动部署属于 "),t("code",[s._v("Gitee Pages Pro")]),s._v(" 的服务，99/年。如果你开通了，或者你不介意自己去更新，按照下面的部署更简单。")]),s._v(" "),t("p",[s._v("参考上面 "),t("a",{attrs:{href:"#%E8%BF%9C%E7%A8%8B%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"}},[s._v("Github Pages / 远程自动部署")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Gitee 账号下 "),t("code",[s._v("设置/私人令牌/+生成新令牌")]),s._v(" 创建 Gitee 私人令牌，配置名字为 "),t("code",[s._v("GITEE_ACCESS_TOKEN")]),s._v(" 的 secrets 到 "),t("code",[s._v("github代码仓库")]),s._v(" 的 "),t("code",[s._v("Settings/secrets/actions")]),s._v(" 下。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("ci.yml")]),s._v(" 中设置 "),t("code",[s._v("GITEE_TOKEN")]),s._v(" 环境变量：")])])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" run deploy.sh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤3")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("GITHUB_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("GITEE_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.GITEE_ACCESS_TOKEN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yarn "),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" yarn deploy\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ul",[t("li",[s._v("在 "),t("code",[s._v("deploy.sh")]),s._v(" 中 "),t("code",[s._v("# 退回开始所在目录 cd -")]),s._v(" 之前新增：")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# deploy to gitee")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'www.example.com' > CNAME")]),s._v("\n\nif "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('z "$GITEE_ACCESS_TOKEN" '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("; then\n  giteeUrl=https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//gitee.com/runss11/blog.git\nelse\n  giteeUrl=https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//runss11"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("GITEE_ACCESS_TOKEN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("@gitee.com/runss11/blog.git\nfi\n \ngit add "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("A\ngit commit "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('m "$'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v('"\ngit push '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("f $giteeUrl master "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送到 gitee 仓库的 master 下")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])])]),s._v(" "),t("h3",{attrs:{id:"同步并部署到gitee"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同步并部署到gitee"}},[s._v("#")]),s._v(" 同步并部署到Gitee")]),s._v(" "),t("h4",{attrs:{id:"新建-gitee-仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建-gitee-仓库"}},[s._v("#")]),s._v(" 新建 Gitee 仓库")]),s._v(" "),t("p",[s._v("登录"),t("code",[s._v("Gitee")]),s._v("，点击右上角 "),t("code",[s._v("+")]),s._v("，选择 "),t("code",[s._v("新建仓库")]),s._v(" 新建 "),t("code",[s._v("blog")]),s._v(" 仓库，跟 github 仓库一样。(由配置中的 "),t("code",[s._v("base")]),s._v(" 决定)")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/giteeNewRep1.1lwefbkhfk1s.webp",alt:"giteeNewRep1"}})]),s._v(" "),t("h4",{attrs:{id:"产生-ssh-key"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#产生-ssh-key"}},[s._v("#")]),s._v(" 产生 SSH Key")]),s._v(" "),t("ul",[t("li",[s._v("打开 "),t("code",[s._v("Git Bash")]),s._v(" 查看是否生成过 SSH 密钥。")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" ~/.ssh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看是否存在 id_rsa  id_rsa.pub ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("没有则需要产生新的 "),t("code",[s._v("SSH")]),s._v(" 密钥对，"),t("code",[s._v("Git Bash")]),s._v(" 输入：")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ssh-keygen "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"youremail@example.com"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 替换你绑定gitee的邮箱")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/sshkey.236zl8kbqrhc.webp",alt:"sshkey"}})]),s._v(" "),t("blockquote",[t("p",[s._v("一直回车就好，不要设置密码")])]),s._v(" "),t("p",[s._v("查看生成的密钥对：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v("  ~/.ssh \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" id_rsa.pub "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看公钥数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" id_rsa "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看私钥数据")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/sshkey1.3fndkh0kdo5c.webp",alt:"sshkey1"}})]),s._v(" "),t("blockquote",[t("p",[s._v("id_rsa.pub 为RSA公钥，id_rsa 为RSA私钥。非对称密钥，一个用于加密，另外一个用于解密。")])]),s._v(" "),t("h4",{attrs:{id:"配置-ssh-key"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-ssh-key"}},[s._v("#")]),s._v(" 配置 SSH Key")]),s._v(" "),t("ul",[t("li",[s._v("复制公钥 "),t("code",[s._v("id_rsa.pub")]),s._v(" 数据，在 "),t("code",[s._v("Github")]),s._v(" 账户的 "),t("code",[s._v("Settings/SSH and GPG keys")]),s._v(" 下添加 SSH 公钥。"),t("a",{attrs:{href:"https://github.com/settings/keys",target:"_blank",rel:"noopener noreferrer"}},[s._v("点这里过去"),t("OutboundLink")],1)])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubAddSSHkey.1rms4in3fwm8.webp",alt:"githubAddSSHkey"}})]),s._v(" "),t("ul",[t("li",[s._v("同样，在 "),t("code",[s._v("Gitee")]),s._v(" 账户的 "),t("code",[s._v("设置/安全设置/SSH公钥")]),s._v(" 下添加 SSH 公钥。"),t("a",{attrs:{href:"https://gitee.com/profile/sshkeys",target:"_blank",rel:"noopener noreferrer"}},[s._v("点这里过去"),t("OutboundLink")],1)])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/giteeAddSSHkey.2qg4nxd92gow.webp",alt:"giteeAddSSHkey"}})]),s._v(" "),t("ul",[t("li",[s._v("测试配置是否成功")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T")]),s._v(" git@github.com\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T")]),s._v(" git@gitee.com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/sshkey2.n7ab447484w.webp",alt:"sshkey2"}})]),s._v(" "),t("h4",{attrs:{id:"配置-github-secrets"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-github-secrets"}},[s._v("#")]),s._v(" 配置 Github Secrets")]),s._v(" "),t("p",[s._v("参考上面 "),t("a",{attrs:{href:"#%E8%BF%9C%E7%A8%8B%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"}},[s._v("Github Pages / 远程自动部署")]),s._v(" 下的配置 ACCESS_TOKEN 步骤，在 "),t("code",[s._v("Github 代码仓库")]),s._v(" 即 "),t("code",[s._v("vuepress-vdoing-blog 仓库")]),s._v(" 的 "),t("code",[s._v("Settings/secrets/actions")]),s._v(" 下配置如下 Secrets：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubSecrets4.6p9tkjs8alts.webp",alt:"githubSecrets4"}})]),s._v(" "),t("blockquote",[t("p",[t("code",[s._v("GITEE_PASSWORD")]),s._v(" 为你的 "),t("code",[s._v("Gitee 密码")]),t("br"),s._v(" "),t("code",[s._v("SSH_RSA_PRIVATE_KEY")]),s._v(" 为 "),t("code",[s._v("id_rsa")]),s._v(" 私钥数据")])]),s._v(" "),t("h4",{attrs:{id:"配置-action-脚本-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-action-脚本-2"}},[s._v("#")]),s._v(" 配置 action 脚本")]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v(".github/workflows")]),s._v(" 目录下新建 "),t("code",[s._v("gitee.yml")]),s._v(" 脚本，脚本名字可以自定义")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitee\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 'ci.yml' workflow 完成之后运行")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflows")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ci"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("types")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" completed\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持手动，方便测试 (在github仓库的 action 下对应的 action 开启了 Runs workflow 按钮)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_dispatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工作流")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ci-success")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义名称, ci.yml 运行成功时才会执行")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行在最新的ubuntu虚拟机环境")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" github.event.workflow_run.conclusion == 'success' "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 失败时执行是 'failure'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Mirror To Gitee "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤1：将 GitHub 仓库同步到 Gitee 仓库")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wearerequired/git"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mirror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SSH_PRIVATE_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.SSH_RSA_PRIVATE_KEY "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id_rsa 私钥")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source-repo 同步到 destination-repo")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("source-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@github.com:foreverRuns/blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Github 仓库地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("destination-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@gitee.com:runss11/blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Gitee 仓库地址")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Build Gitee Pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤2：自动部署到 Gitee Pages")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yanglbme/gitee"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Gitee 用户名")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-username")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" RunSS11\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在Settings/Secrets/Actions/New repository secret/ 新建 GITEE_PASSWORD，存放你的 Gitee 帐户密码")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.GITEE_PASSWORD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  Gitee 仓库地址，（地址仅需后缀，即 https://gitee.com/<username>/xxx 的 <username>/xxx 即可）")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" runss11/blog\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支，默认是 master，若是其他分支，则需要指定（指定的分支必须存在）")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支上的目录")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# directory:")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否强制使用 HTTPS, 默认true")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https: true")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])]),t("blockquote",[t("p",[s._v("脚本中用到的 "),t("code",[s._v("secrets.SSH_RSA_PRIVATE_KEY")]),s._v(" 、 "),t("code",[s._v("secrets.GITEE_PASSWORD")]),s._v(" 就是上面配置的环境变量")])]),s._v(" "),t("p",[s._v("先使用 "),t("a",{attrs:{href:"https://github.com/wearerequired/git-mirror-action",target:"_blank",rel:"noopener noreferrer"}},[s._v("wearerequired/git-mirror-action"),t("OutboundLink")],1),s._v(" 将 GitHub 仓库同步到 Gitee 仓库，再使用 "),t("a",{attrs:{href:"https://github.com/yanglbme/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[s._v("yanglbme/gitee-pages-action"),t("OutboundLink")],1),s._v(" 实现 Gitee Pages 的自动部署。")]),s._v(" "),t("p",[s._v("如果一切配置正常，并成功触发 Gitee Pages Action ，Gitee Pages Action 会打印出成功的结果，并且我们会在 Gitee 公众号收到一条登录通知。这是 Gitee Pages Action 程序帮我们登录到 Gitee 官网，并为我们点击了仓库 Gitee Pages 服务的 "),t("code",[s._v("更新")]),s._v(" 部署按钮。")]),s._v(" "),t("p",[s._v("至此，我们只要在本地 "),t("code",[s._v("push")]),s._v(" 代码到 github 仓库的 "),t("code",[s._v("main")]),s._v(" 分支，就会在远程自动部署到 "),t("code",[s._v("Github Pages")]),s._v(" 和 "),t("code",[s._v("Gitee Pages")]),s._v(" 上")]),s._v(" "),t("p",[s._v("部署日志：\n"),t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubActionLog1.246c4zxzf8lc.webp",alt:"githubActionLog1"}})]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("注意")]),s._v("：首次需要手动登录 Gitee ，进入项目 "),t("code",[s._v("服务")]),s._v(" 下的 "),t("code",[s._v("Gitee Pages")]),s._v("，手动点击 "),t("code",[s._v("启动")]),s._v(" 进行 Gitee Pages 服务的部署。启动后变为 "),t("code",[s._v("更新")]),s._v(" 按钮，我们通过上面的 "),t("code",[s._v("gitee-pages-action")]),s._v(" 去实现后续的自动更新。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/giteePages.33l1vmwj9p4w.webp",alt:"giteePages"}})]),s._v(" "),t("h4",{attrs:{id:"错误及解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#错误及解决方案"}},[s._v("#")]),s._v(" 错误及解决方案")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("Error: Rebuild page error, status code: xxx")])])]),s._v(" "),t("blockquote",[t("p",[s._v("Gitee Pages 未初始化，第一次需要手动部署。在部署仓库的 "),t("code",[s._v("服务/Gitee Pages")]),s._v(" 下，手动点击 "),t("code",[s._v("启动")]),s._v(" 按钮。"),t("br"),s._v("\n如果启动过，有可能是更新 Pages 时状态码异常，请尝试再次触发 Action 执行。")])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("其他问题自行 "),t("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看官方文档"),t("OutboundLink")],1),s._v("，拉到最后的 "),t("code",[s._v("错误及解决方案")]),s._v("。")])]),s._v(" "),t("h3",{attrs:{id:"同步项目源码到gitee"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同步项目源码到gitee"}},[s._v("#")]),s._v(" 同步项目源码到Gitee")]),s._v(" "),t("blockquote",[t("p",[s._v("将 GitHub 上的项目源码同步到 Gitee 仓库下，如果你不需要可以跳过这一步骤。")])]),s._v(" "),t("ol",[t("li",[s._v("登录"),t("code",[s._v("Gitee")]),s._v("，点击右上角 "),t("code",[s._v("+")]),s._v("，选择 "),t("code",[s._v("新建仓库")]),s._v(" 新建一个仓库用于同步项目源码，名字跟 Github 上一样")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/giteeNewRep.6ycx2sy51l6o.webp",alt:"giteeNewRep"}})]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("配置 Github Secrets")])]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v("Github 代码仓库")]),s._v(" 即 "),t("code",[s._v("vuepress-vdoing-blog 仓库")]),s._v(" 的 "),t("code",[s._v("Settings/secrets/actions")]),s._v(" 下， 新建名称为 "),t("code",[s._v("SSH_RSA_PRIVATE_KEY")]),s._v(" 的 secret，内容为 "),t("code",[s._v("id_rsa")]),s._v(" 私钥数据。")]),s._v(" "),t("blockquote",[t("p",[s._v("由于我们在上面的 "),t("a",{attrs:{href:"#%E5%90%8C%E6%AD%A5%E5%B9%B6%E9%83%A8%E7%BD%B2%E5%88%B0gitee"}},[s._v("Gitee Pages / 同步并部署到Gitee")]),s._v(" 下的 "),t("code",[s._v("配置 Github Secrets")]),s._v(" 步骤已经配置过 "),t("code",[s._v("SSH_RSA_PRIVATE_KEY")]),s._v("，这里就不需要再配置了。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubSecrets.58y3u32lxgcg.webp",alt:"githubSecrets"}})]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("修改 "),t("code",[s._v(".github/workflows/gitee.yml")]),s._v(" 脚本：")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitee\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 'ci.yml' workflow 完成之后运行")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflows")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ci"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("types")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" completed\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持手动，方便测试 (在github仓库的 action 下对应的 action 开启了 Runs workflow 按钮)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_dispatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工作流")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ci-success")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义名称, ci.yml 运行成功时才会执行")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行在最新的ubuntu虚拟机环境")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" github.event.workflow_run.conclusion == 'success' "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 失败时执行是 'failure'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Mirror To Gitee "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤1：将 GitHub 仓库同步到 Gitee 仓库")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wearerequired/git"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mirror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SSH_PRIVATE_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.SSH_RSA_PRIVATE_KEY "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id_rsa 私钥")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source-repo 同步到 destination-repo")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("source-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@github.com:foreverRuns/vuepress-vdoing-blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Github 仓库地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("destination-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@gitee.com:runss11/vuepress-vdoing-blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Gitee 仓库地址")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Mirror To Gitee "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤2：将 GitHub 仓库同步到 Gitee 仓库")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wearerequired/git"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mirror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SSH_PRIVATE_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.SSH_RSA_PRIVATE_KEY "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id_rsa 私钥")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source-repo 同步到 destination-repo")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("source-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@github.com:foreverRuns/blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Github 仓库地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("destination-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git@gitee.com:runss11/blog.git'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Gitee 仓库地址")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Build Gitee Pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤3：自动部署到 Gitee Pages")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yanglbme/gitee"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Gitee 用户名")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-username")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" RunSS11\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在Settings/Secrets/Actions/New repository secret/ 新建 GITEE_PASSWORD，存放你的 Gitee 帐户密码")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.GITEE_PASSWORD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  Gitee 仓库地址，（地址仅需后缀，即 https://gitee.com/<username>/xxx 的 <username>/xxx 即可）")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" runss11/blog\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支，默认是 master，若是其他分支，则需要指定（指定的分支必须存在）")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支上的目录")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# directory:")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否强制使用 HTTPS, 默认true")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https: true")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br")])]),t("h2",{attrs:{id:"私密数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#私密数据"}},[s._v("#")]),s._v(" 私密数据")]),s._v(" "),t("blockquote",[t("p",[s._v("在本站评论的搭建中，不管是 Gitalk 的 "),t("code",[s._v("Client ID")]),s._v(" 和 "),t("code",[s._v("Client secret")]),s._v("，还是 Valine 的 "),t("code",[s._v("AppID")]),s._v(" 和 "),t("code",[s._v("AppKey")]),s._v("，都属于私密数据，不应该直接写在配置中。")])]),s._v(" "),t("h3",{attrs:{id:"本地获取"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地获取"}},[s._v("#")]),s._v(" 本地获取")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("docs/.vuepress/config")]),s._v(" 下新建 "),t("code",[s._v("secrets.js")]),s._v("，根据自己使用的评论系统配置")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// gitalk")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// clientID: 'Your own clientID',")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// clientSecret: 'Your own clientSecret',")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// valine")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("appId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Your own appId'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 替换为你的appId，如：kSuWQbsktacrorUwyB5jrkkW-gzGjcHsz")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("appKey")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Your own appKey'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 替换为你的appKey，如：8vbYX017fTIKYmljkjr506P6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("修改插件配置 "),t("code",[s._v("docs/.vuepress/config/plugins.js")]),s._v("，根据自己使用的评论系统配置")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// const { clientID, clientSecret } = require('./secrets.js')")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" appId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" appKey "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./secrets.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("plugins")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 其他插件配置")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vuepress-plugin-comment'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// {")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   choosen: 'gitalk',")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   options: {")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     clientID,")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     clientSecret,")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     repo: 'gitalk-comment-blog', // GitHub 仓库")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     owner: 'foreverRuns', // GitHub仓库所有者")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     admin: ['foreverRuns'], // 对仓库有写权限的人")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     // distractionFreeMode: true,")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     pagerDirection: 'last', // 'first'正序 | 'last'倒序")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     id: '<%- (frontmatter.permalink || frontmatter.to.path).slice(-16) %>', //  页面的唯一标识,长度不能超过50")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     title: '「评论」<%- frontmatter.title %>', // GitHub issue 的标题")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     labels: ['Gitalk', 'Comment'], // GitHub issue 的标签")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     body: '页面：<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>', // GitHub issue 的内容")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   },")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// },")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 具体参数请看官网：https://valine.js.org/")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("choosen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'valine'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("options")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("el")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#valine-vuepress-comment'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          appId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ES6 语法，相当于 appId: appId")]),s._v("\n          appKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<%- frontmatter.commentid || frontmatter.permalink %>'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("placeholder")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'评论点啥 ~~~'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 评论框占位提示符")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("avatar")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'monsterid'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 小怪物头像. 目前非自定义头像有7种默认值可选: https://valine.js.org/avatar.html")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("pageSize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 评论列表分页，每页条数")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("visitor")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 文章访问量统计")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("recordIP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否记录评论者 IP 地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("enableQQ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否启用昵称框自动获取 QQ 昵称和 QQ 头像, 默认关闭")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("根目录下 "),t("code",[s._v(".gitignore")]),s._v(" 文件中，忽略 "),t("code",[s._v("docs/.vuepress/config/secrets.js")]),s._v(" 文件，不上传到 GitHub 仓库中")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br")]),t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// .gitignore")]),s._v("\nnode_modules\nyarn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vscode\ndocs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vuepress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dist\ndocs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vuepress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("secrets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("blockquote",[t("p",[s._v("至此，本地运行 "),t("code",[s._v("yarn dev")]),s._v("，或者本地手动部署 "),t("code",[s._v("yarn deploy")]),s._v(" 时，私密数据从 "),t("code",[s._v("secrets.js")]),s._v(" 中获取。由于该文件只存在于本地中，不会上传到远程仓库中，不会泄露比较安全。")])]),s._v(" "),t("h3",{attrs:{id:"远程获取"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#远程获取"}},[s._v("#")]),s._v(" 远程获取")]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("code",[s._v("Github Actions")]),s._v(" 自动部署时，由于不存在 "),t("code",[s._v("secrets.js")]),s._v("，在 Github 服务器构建打包时会出错，我们需要在打包之前动态生成 "),t("code",[s._v("secrets.js")]),s._v(" 配置文件")])]),s._v(" "),t("ul",[t("li",[s._v("将 Gitalk 的 "),t("code",[s._v("Client ID")]),s._v("、"),t("code",[s._v("Client secret")]),s._v("，或者 Valine 的 "),t("code",[s._v("AppID")]),s._v("、"),t("code",[s._v("AppKey")]),s._v(" 配置到 Github 代码仓库中的 "),t("code",[s._v("Secrets")]),s._v(" 下，根据自己使用的评论系统配置。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubSecrets3.4ryn80wshiww.webp",alt:"githubSecrets3"}})]),s._v(" "),t("ul",[t("li",[s._v("修改 "),t("code",[s._v(".github/workflows/ci.yml")]),s._v(" 文件，新增设置私密数据环境变量")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CI\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 触发条件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在master分支发生push事件时触发。")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("push")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" main\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mater\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持手动，方便测试 (在github仓库的action下对应的action开启了Runs workflow 按钮)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_dispatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时区（设置时区可使页面中的`最近更新时间`使用时区时间）")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工作流")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义名称")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行在最新的ubuntu虚拟机环境")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("strategy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matrix")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("14.x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Checkout "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤1 拉取代码")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用的动作。格式：userName/repoName。作用：检出仓库，获取源码。 官方actions库：https://github.com/actions")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Number of commits to fetch. 0 indicates all history for all branches and tags.")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default: 1")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fetch-depth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0 表示获取所有分支和标签的所有 Commit 记录。 (文章底部的 `最近更新时间` 对应该文章的 commit 提交时间，没有设置这个会出现问题)")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Use Node.js $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" matrix.node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("version "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤2")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node@v1 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 作用：安装nodejs")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" matrix.node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("version "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" run deploy.sh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤3")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("GITHUB_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# toKen私密变量 (在 仓库/Settings/Secrets/Actions/ 下， New repository secret 创建)")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("VALINE_APPID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.VALINE_APPID "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("VALINE_APPKEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.VALINE_APPKEY "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yarn "),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" yarn deploy "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖，执行deploy.sh")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("修改根目录的部署脚本 "),t("code",[s._v("deploy.sh")]),s._v("，新增在 "),t("code",[s._v("Github Actions")]),s._v(" 自动部署时动态生成 "),t("code",[s._v("secrets.js")]),s._v(" 私密数据文件")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是 github action 自动部署，动态生成 secret.js")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GITHUB_TOKEN")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"module.exports = {\n    // clientID: '"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GITALK_CLIENTID}")]),s._v("',\n    // clientSecret: '"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GITALK_CLIENTSECRET}")]),s._v("',\n    appId: '"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${VALINE_APPID}")]),s._v("',\n    appKey: '"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${VALINE_APPKEY}")]),s._v("'\n  }\"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" docs/.vuepress/config/secrets.js\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到自定义域名，请使用，不填则使用 GitHub 自带的 <username>.github.io")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'www.example.com' > CNAME")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-z")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GITHUB_TOKEN")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("msg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'本地手动部署'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地 yarn deploy")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("githubUrl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://github.com/foreverRuns/blog\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("msg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitHub Actions 自动部署'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("githubUrl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://foreverRuns:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GITHUB_TOKEN}")]),s._v("@github.com/foreverRuns/blog.git\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Omit --global to set the identity only in this repository.")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foreverRuns"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.email "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"894xxxx40@qq.com"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${msg}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$githubUrl")]),s._v(" master:gh-pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 master 分支 推送到 blog 仓库下的 gh-pages分支")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退回开始所在目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除打包项目")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" docs/.vuepress/dist\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br")])]),t("blockquote",[t("p",[s._v("至此，在本地运行 "),t("code",[s._v("yarn dev")]),s._v("，或者本地手动部署 "),t("code",[s._v("yarn deploy")]),s._v(" 时，私密数据从 "),t("code",[s._v("secrets.js")]),s._v(" 中获取，在远程 "),t("code",[s._v("Github Actions")]),s._v(" 自动部署时，私密数据是从环境变量中获取的，从而保证了私密数据的安全性。")])]),s._v(" "),t("h2",{attrs:{id:"自定义域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义域名"}},[s._v("#")]),s._v(" 自定义域名")]),s._v(" "),t("h3",{attrs:{id:"申请域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#申请域名"}},[s._v("#")]),s._v(" 申请域名")]),s._v(" "),t("p",[s._v("申请域名可以去阿里云，腾讯云等，下面以腾讯云为例：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("前往 "),t("a",{attrs:{href:"https://dnspod.cloud.tencent.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("腾讯云域名注册"),t("OutboundLink")],1),s._v("，搜索并找到你想要可用的域名，然后👉买它。")])]),s._v(" "),t("li",[t("p",[s._v("进入 "),t("a",{attrs:{href:"https://console.cloud.tencent.com/domain",target:"_blank",rel:"noopener noreferrer"}},[s._v("控制台/产品监控/域名管理"),t("OutboundLink")],1),s._v("，域名列表中选择刚才的域名解析：")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/ymjx.4ngrq97u5hc0.webp",alt:"ymjx"}})]),s._v(" "),t("ul",[t("li",[s._v("进入域名解析页面，点击 "),t("code",[s._v("添加记录")]),s._v(" 添加解析记录。")])]),s._v(" "),t("ol",[t("li",[s._v("主机记录："),t("code",[s._v("@")]),s._v("，表示直接解析主域名 "),t("code",[s._v("runss.top")]),s._v("，选择 "),t("code",[s._v("www")]),s._v(" 就是 "),t("code",[s._v("www.runss.top")])]),s._v(" "),t("li",[s._v("记录类型："),t("code",[s._v("CNAME")]),s._v("，表示将域名指向另一个域名地址，与其保持相同解析，如 https://www.dnspod.cn，选择 "),t("code",[s._v("A")]),s._v(" 就是将域名指向一个 IPv4 地址")]),s._v(" "),t("li",[s._v("解析线路："),t("code",[s._v("默认")])]),s._v(" "),t("li",[s._v("记录值：若选择 "),t("code",[s._v("CNAME")]),s._v("，则在此填写要指向的域名地址，如你的 Github Pages 地址："),t("code",[s._v("userName.github.io")]),s._v("，不包括仓库名称；若选择 "),t("code",[s._v("A")]),s._v("，则在此填写服务器 IP 地址")]),s._v(" "),t("li",[s._v("权重："),t("code",[s._v("空着")]),s._v("，表示负载均衡权重默认为均等负载")]),s._v(" "),t("li",[s._v("TTL："),t("code",[s._v("600")]),s._v("，默认值即可")]),s._v(" "),t("li",[s._v("确定")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/ymjx1.6zzhc0a508c.webp",alt:"ymjx1"}})]),s._v(" "),t("ul",[t("li",[s._v("申请SSL证书")])]),s._v(" "),t("p",[s._v("记录添加成功后，在记录的 "),t("code",[s._v("SSL")]),s._v(" 选项悬浮鼠标，选择 "),t("code",[s._v("免费申请")]),s._v("，然后选择 "),t("code",[s._v("个人用户版本")]),s._v(" 免费申请。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/ymjx2.3ryka5r5a41s.webp",alt:"ymjx2"}})]),s._v(" "),t("p",[s._v("提交申请之后腾讯云会自动帮你添加一条解析记录，等一会就会审核通过。")]),s._v(" "),t("h3",{attrs:{id:"github-pages-自定义域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github-pages-自定义域名"}},[s._v("#")]),s._v(" GitHub Pages 自定义域名")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("CNAME")]),s._v(" 记录应该始终指向 "),t("code",[s._v("<user>.github.io")]),s._v(" 或 "),t("code",[s._v("<organization>.github.io")]),s._v("，不包括仓库名称。")])]),s._v(" "),t("li",[t("p",[s._v("在配置 "),t("code",[s._v("用户或组织站点")]),s._v(" 的自定义域后，"),t("code",[s._v("自定义域名")]),s._v(" 将替换该账户下所有开通 Pages 但 "),t("code",[s._v("未配置自定义域")]),s._v(" 网站 URL 的 "),t("code",[s._v("<user>.github.io")]),s._v(" 或 "),t("code",[s._v("<organization>.github.io")]),s._v(" 部分。"),t("br"),s._v("\n例如，你的 "),t("code",[s._v("用户站点")]),s._v(" 的自定义域名为 "),t("code",[s._v("www.example.com")]),s._v("，并且你拥有一个 "),t("code",[s._v("未自定义域名")]),s._v("的 "),t("code",[s._v("项目网站")]),s._v("，该网站从名为 "),t("code",[s._v("blog")]),s._v(" 的仓库发布，\n则该仓库的 GitHub Pages 网站将在 "),t("code",[s._v("www.example.com/blog")]),s._v(" 上发布。")])]),s._v(" "),t("li",[t("p",[s._v("更详细的说明 "),t("a",{attrs:{href:"https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages",target:"_blank",rel:"noopener noreferrer"}},[s._v("看这里"),t("OutboundLink")],1)])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[t("code",[s._v("用户站点")]),s._v("：指的是名为 "),t("code",[s._v("<username>.github.io")]),s._v(" 的用户仓库")])]),s._v(" "),t("p",[s._v("基于上面的说明：")]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("点击查看")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("如果你直接在部署仓库 "),t("code",[s._v("blog")]),s._v(" 下配置自定义域 "),t("code",[s._v("www.example.com")]),s._v("，然后直接通过 "),t("code",[s._v("www.example.com")]),s._v(" 访问，在这里样式会出现问题，需要在 "),t("code",[s._v("docs/.vuepress/config.js")]),s._v(" 中将 "),t("code",[s._v("base")]),s._v(" 配置为 "),t("code",[s._v("'/'")]),s._v("，才可正常访问。但是这样访问之前的 "),t("code",[s._v("https://<username>.github.io/blog")]),s._v(" 和 "),t("code",[s._v("https://<username>.gitee.io/blog")]),s._v(" 会出样式问题。")])]),s._v(" "),t("li",[t("p",[s._v("如果你创建过用户站点，即存在 "),t("code",[s._v("<username>.github.io")]),s._v(" 的用户仓库，那么你可以直接为这个仓库配置自定义域 "),t("code",[s._v("www.example.com")]),s._v("，那么你就能通过 "),t("code",[s._v("www.example.com/blog")]),s._v(" 正常访问到你的博客网站了。")])])])]),s._v(" "),t("ol",[t("li",[s._v("修改部署仓库 "),t("code",[s._v("blog")]),s._v(" 为 "),t("code",[s._v("<username>.github.io")]),s._v("，即改成用户站点。")]),s._v(" "),t("li",[s._v("在项目根目录下的 "),t("code",[s._v("deploy.sh")]),s._v(" 脚本，配置自定义域。")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'runss.top'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" CNAME "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# // 域名替换成你的")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[t("code",[s._v("docs/.vuepress/config.js")]),s._v(" 中，将 "),t("code",[s._v("base")]),s._v(" 屏蔽或者配置为 "),t("code",[s._v("'/'")]),s._v("。")])]),s._v(" "),t("p",[s._v("提交代码部署成功后就可以通过自定义域名访问了。 本站："),t("a",{attrs:{href:"https://runss.top",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://runss.top"),t("OutboundLink")],1),t("br"),s._v("\n并且可以通过 "),t("code",[s._v("自定义域名/仓库名称")]),s._v(" 来访问该账户下所有开通 Pages 但 "),t("code",[s._v("未配置自定义域")]),s._v(" 的站点。 如："),t("a",{attrs:{href:"https://runss.top/vip",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://runss.top/vip"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("配置自定义域时，如果是在 Github 仓库下手动配置："),t("br"),s._v(" "),t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/githubPages.2sboby3bz3k0.webp",alt:"githubPages"}}),s._v("\n其实也是在仓库下生成 "),t("code",[s._v("CNAME")]),s._v(" 文件，如果 "),t("code",[s._v("deploy.sh")]),s._v(" 脚本不自动生成 "),t("code",[s._v("CNAME")]),s._v(" 文件，下次自动部署强制推送就会把仓库配置的 "),t("code",[s._v("CNAME")]),s._v(" 文件删除了，所以自定义域会失效。")])]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("点击查看")]),s._v(" "),t("p",[s._v("配置 "),t("code",[s._v("@")]),s._v(" 和 "),t("code",[s._v("www")]),s._v(" 两个解析记录：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/ymjx3.406uaoymea0w.webp",alt:"ymjx3"}})]),s._v(" "),t("p",[s._v("然后自定义域配置为 "),t("code",[s._v("wwww")]),s._v(" 记录:")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'www.runss.top'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" CNAME "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# // 域名替换成你的")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),s._v(" "),t("p",[s._v("那么访问 "),t("a",{attrs:{href:"https://runss.top",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://runss.top"),t("OutboundLink")],1),s._v(" 就会被重定向到 "),t("a",{attrs:{href:"https://www.runss.top",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runss.top"),t("OutboundLink")],1),s._v("，两者都可以访问到本站。")])]),s._v(" "),t("p",[s._v("由于更改了 "),t("code",[s._v("base")]),s._v("，那么之前部署到 Gitee 的仓库地址也需要修改，否则会出现样式丢失问题。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/giteeName.244kc164sqtc.webp",alt:"giteeName"}})]),s._v(" "),t("p",[s._v("这样就可以通过 "),t("code",[s._v("https://<username>.gitee.io")]),s._v(" 正常访问了，本站："),t("a",{attrs:{href:"https://runss11.gitee.io",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://runss11.gitee.io"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("修改了 Gitee 部署仓库地址也要记得修改 "),t("code",[s._v("gitee.yml")]),s._v(" 中的地址")])]),s._v(" "),t("h3",{attrs:{id:"gitee-pages-自定义域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitee-pages-自定义域名"}},[s._v("#")]),s._v(" Gitee Pages 自定义域名")]),s._v(" "),t("p",[s._v("Gitee Pages 自定义域名功能需要开通 "),t("code",[s._v("Gitee Pages Pro")]),s._v(" 才支持，具体看 "),t("a",{attrs:{href:"https://gitee.com/help/articles/4228",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"seo-优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#seo-优化"}},[s._v("#")]),s._v(" SEO 优化")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1777576",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考这里"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"百度推送"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#百度推送"}},[s._v("#")]),s._v(" 百度推送")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("前往 "),t("a",{attrs:{href:"https://ziyuan.baidu.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度搜索资源平台/原百度站长"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[s._v("添加站点，然后验证，百度提供了三种验证方式，本站使用 "),t("code",[s._v("CNAME")]),s._v(" 解析验证")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/baidu.78g91b677ls0.webp",alt:"baidu"}})]),s._v(" "),t("ul",[t("li",[s._v("验证通过后在 "),t("code",[s._v("普通收录/资源提交/API提交/curl推送示例")]),s._v(" 下获取命令")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.staticaly.com/gh/foreverRuns/image-hosting@main/blog/baidu1.4hsk0gsnm000.webp",alt:"baidu1"}})]),s._v(" "),t("ul",[t("li",[s._v("然后 "),t("a",{attrs:{href:"https://xugaoyi.com/pages/f44d2f9ad04ab8d3/",target:"_blank",rel:"noopener noreferrer"}},[s._v("看这里"),t("OutboundLink")],1)])])],1)}),[],!1,null,null,null);t.default=n.exports}}]);